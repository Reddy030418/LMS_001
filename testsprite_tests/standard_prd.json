{
  "meta": {
    "project": "ANU Library Management System (ANU LMS)",
    "date": "2026-02-21",
    "prepared_by": "Generated by TestSprite"
  },
  "product_overview": "ANU LMS is a Django-based web application that digitizes library workflows — catalog discovery, requests, issuing/returns, analytics, and AI recommendations — for students, librarians, and admins. It exposes session-protected JSON APIs for dashboards and supports exportable reports (CSV/PDF).",
  "core_goals": [
    "Digitize the complete book lifecycle (request → issue → return) with automatic due-date and fine calculation",
    "Provide role-based dashboards and JSON APIs for analytics and reporting",
    "Enable fast book discovery (basic, advanced, AJAX suggestions) and curated collections",
    "Streamline librarian operations: manage requests, low-stock alerts, and bulk exports (CSV/PDF)",
    "Deliver personalized recommendations (rule-based + LLM fallback) with per-user caching",
    "Support asynchronous notifications via Celery and production-ready deployment on PostgreSQL + Redis"
  ],
  "features": [
    {
      "name": "Authentication",
      "description": "User registration, login/logout, profile viewing and change-password flows for students, librarians, and admins (session-based auth).",
      "user_flows": [
        "GET /accounts/login/ -> Receive 200 HTML login page -> POST /accounts/login/ with valid credentials in body {username,password} -> Receive 302 redirect to role-based dashboard -> GET /accounts/profile/ with session cookie -> Receive 200 HTML profile page",
        "POST /accounts/login/ with invalid credentials -> Receive 200 login page with form errors",
        "GET /accounts/register/ -> Receive 200 HTML registration page -> POST /accounts/register/ with body {username,email,password1,password2} valid -> Receive 302 redirect to login -> POST /accounts/register/ with mismatched/invalid data -> Receive 200 registration page with errors",
        "GET /accounts/logout/ with authenticated session -> Receive 302 redirect to login",
        "POST /accounts/change-password/ with authenticated session and valid body {old_password,new_password1,new_password2} -> Receive 302 redirect on success",
        "POST /accounts/change-password/ with wrong old_password -> Receive 200 form with errors"
      ]
    },
    {
      "name": "Book Management",
      "description": "Browse, view and search the book catalog (basic & advanced), get autocomplete suggestions, and view curated collections and book detail metadata.",
      "user_flows": [
        "GET /books/ -> Receive 200 HTML book list page (paginated)",
        "GET /books/123/ -> Receive 200 HTML book detail page with metadata, availability and similar books",
        "GET /books/9999/ -> Receive 404 Not found",
        "GET /search/?q=algorithms -> Receive 200 HTML search results page",
        "GET /advanced-search/?title=algorithms&department=2&year=2020 -> Receive 200 HTML advanced search results page",
        "GET /search-suggestions/?q=algo -> Receive 200 JSON array of suggestions (top 5)",
        "GET /trending-books/ -> Receive 200 HTML trending books page",
        "GET /new-arrivals/ -> Receive 200 HTML new arrivals page",
        "GET /rare-books/ -> Receive 200 HTML rare books page"
      ]
    },
    {
      "name": "Book Transactions",
      "description": "Student requests, librarian issues and returns books; transaction history and export of transaction data to CSV/PDF.",
      "user_flows": [
        "POST /request-book/123/ with authenticated student session -> Receive 302 redirect on success (or 200 form with errors if validation fails)",
        "POST /request-book/123/ without session -> Receive 302 redirect to login",
        "POST /issue-book/ with authenticated librarian session and body {student_id: \"2022CSE001\", book_id: 123} -> Receive 302 redirect on success",
        "POST /issue-book/ with missing or invalid body -> Receive 200 form with error",
        "POST /return-book/456/ with authenticated librarian session -> Receive 302 redirect on success",
        "POST /return-book/9999/ with authenticated session -> Receive 404 Transaction not found",
        "GET /my-requests/ with authenticated student session -> Receive 200 HTML requests page",
        "GET /manage-requests/ with authenticated librarian session -> Receive 200 HTML manage requests page",
        "GET /export-transactions-csv/ with authenticated admin/librarian session -> Receive 200 CSV file download",
        "GET /export-transactions-pdf/ with authenticated admin/librarian session -> Receive 200 PDF file download"
      ]
    },
    {
      "name": "Dashboard API",
      "description": "Session-protected JSON API endpoints providing KPIs and data for charts (overall stats, department issues, monthly trends, most-issued, overdue, low-stock, and student-specific data).",
      "user_flows": [
        "GET /api/dashboard/stats/ with authenticated session -> Receive 200 JSON with total_books, issued_books, overdue_books, students",
        "GET /api/department-issues/ with authenticated session -> Receive 200 JSON array of department issue counts",
        "GET /api/monthly-trends/ with authenticated session -> Receive 200 JSON array of monthly data",
        "GET /api/most-issued-books/ with authenticated session -> Receive 200 JSON array of books with issue counts",
        "GET /api/overdue-books/ with authenticated session -> Receive 200 JSON array of overdue transaction records",
        "GET /api/low-stock-books/ with authenticated session -> Receive 200 JSON array of low-stock books",
        "GET /api/student-issued/ with authenticated student session -> Receive 200 JSON array of books currently issued to the logged-in student",
        "GET /api/student-history/ with authenticated student session -> Receive 200 JSON array of historical transactions",
        "GET /api/dashboard/stats/ without authenticated session -> Receive 302 redirect to login (session-based auth required)"
      ]
    },
    {
      "name": "Departmental & E-Resources",
      "description": "Browse academic departments and view books by department, and list e-resources alphabetically by starting letter.",
      "user_flows": [
        "GET /departments/ -> Receive 200 HTML departments page",
        "GET /departments/5/books/ -> Receive 200 HTML department books page",
        "GET /departments/999/books/ -> Receive 404 Department not found",
        "GET /eresources/A/ -> Receive 200 HTML e-resources page listing resources that start with letter 'A'"
      ]
    },
    {
      "name": "Library Services",
      "description": "Contact pages, opening hours, ask-librarian form, study-room booking, and news/announcements.",
      "user_flows": [
        "GET /contact/ -> Receive 200 HTML contact page",
        "GET /opening-hours/ -> Receive 200 HTML opening hours page",
        "POST /ask-librarian/ with body {name,email,message} -> Receive 302 redirect on success or 200 form with errors",
        "POST /book-study-room/ with authenticated session and body {room_id, date, time_slot} -> Receive 302 redirect on success",
        "POST /book-study-room/ without session -> Receive 302 redirect to login",
        "GET /news/ -> Receive 200 HTML news page"
      ]
    }
  ],
  "code_summary": {
    "version": "2",
    "type": "backend",
    "tech_stack": [
      "Python",
      "Django 4.2.7",
      "SQLite (development)",
      "PostgreSQL (production via psycopg2)",
      "Celery",
      "Redis",
      "ReportLab"
    ],
    "features": [
      {
        "name": "Authentication",
        "description": "User registration, login, logout, profile management, and password change",
        "files": [
          "accounts/views.py",
          "accounts/urls.py",
          "accounts/models.py",
          "portal/views.py"
        ],
        "endpoints": [
          {
            "method": "GET",
            "path": "/accounts/login/",
            "description": "Render login page",
            "auth_required": false,
            "response_schema": {
              "200": "HTML login page"
            }
          },
          {
            "method": "POST",
            "path": "/accounts/login/",
            "description": "Authenticate user and create session",
            "auth_required": false,
            "request_schema": {
              "body": {
                "username": "string",
                "password": "string"
              }
            },
            "response_schema": {
              "200": "Login page with errors",
              "302": "Redirect on success"
            }
          },
          {
            "method": "GET",
            "path": "/accounts/logout/",
            "description": "Log out the current user",
            "auth_required": true,
            "response_schema": {
              "302": "Redirect to login"
            }
          },
          {
            "method": "GET",
            "path": "/accounts/register/",
            "description": "Render registration page",
            "auth_required": false,
            "response_schema": {
              "200": "HTML registration page"
            }
          },
          {
            "method": "POST",
            "path": "/accounts/register/",
            "description": "Register a new user",
            "auth_required": false,
            "request_schema": {
              "body": {
                "username": "string",
                "email": "string",
                "password1": "string",
                "password2": "string"
              }
            },
            "response_schema": {
              "200": "Registration page with errors",
              "302": "Redirect on success"
            }
          },
          {
            "method": "GET",
            "path": "/accounts/profile/",
            "description": "View user profile",
            "auth_required": true,
            "response_schema": {
              "200": "HTML profile page"
            }
          },
          {
            "method": "POST",
            "path": "/accounts/change-password/",
            "description": "Change user password",
            "auth_required": true,
            "request_schema": {
              "body": {
                "old_password": "string",
                "new_password1": "string",
                "new_password2": "string"
              }
            },
            "response_schema": {
              "200": "Form with errors",
              "302": "Redirect on success"
            }
          }
        ]
      },
      {
        "name": "Book Management",
        "description": "Browse, search, and manage books in the library",
        "files": [
          "portal/views.py",
          "portal/urls.py",
          "books/models.py"
        ],
        "endpoints": [
          {
            "method": "GET",
            "path": "/books/",
            "description": "List all books",
            "auth_required": false,
            "response_schema": {
              "200": "HTML book list page"
            }
          },
          {
            "method": "GET",
            "path": "/books/<int:book_id>/",
            "description": "Get details for a specific book",
            "auth_required": false,
            "response_schema": {
              "200": "HTML book detail page",
              "404": "Not found"
            }
          },
          {
            "method": "GET",
            "path": "/my-books/",
            "description": "List books currently issued to logged-in student",
            "auth_required": true,
            "response_schema": {
              "200": "HTML my books page"
            }
          },
          {
            "method": "GET",
            "path": "/search/",
            "description": "Search books by keyword",
            "auth_required": false,
            "response_schema": {
              "200": "HTML search results page"
            }
          },
          {
            "method": "GET",
            "path": "/advanced-search/",
            "description": "Search books by multiple filters",
            "auth_required": false,
            "response_schema": {
              "200": "HTML advanced search results page"
            }
          },
          {
            "method": "GET",
            "path": "/search-suggestions/",
            "description": "Autocomplete suggestions for book search",
            "auth_required": false,
            "response_schema": {
              "200": "JSON array of suggestions"
            }
          },
          {
            "method": "GET",
            "path": "/trending-books/",
            "description": "List trending books",
            "auth_required": false,
            "response_schema": {
              "200": "HTML trending books page"
            }
          },
          {
            "method": "GET",
            "path": "/new-arrivals/",
            "description": "List recently added books",
            "auth_required": false,
            "response_schema": {
              "200": "HTML new arrivals page"
            }
          },
          {
            "method": "GET",
            "path": "/rare-books/",
            "description": "List rare/special books",
            "auth_required": false,
            "response_schema": {
              "200": "HTML rare books page"
            }
          },
          {
            "method": "GET",
            "path": "/theses-dissertations/",
            "description": "List theses and dissertations",
            "auth_required": false,
            "response_schema": {
              "200": "HTML theses page"
            }
          },
          {
            "method": "GET",
            "path": "/anu-archives/",
            "description": "List ANU archives",
            "auth_required": false,
            "response_schema": {
              "200": "HTML archives page"
            }
          }
        ]
      },
      {
        "name": "Book Transactions",
        "description": "Request, issue, and return books; export transaction reports",
        "files": [
          "portal/views.py",
          "portal/urls.py",
          "transactions/models.py"
        ],
        "endpoints": [
          {
            "method": "POST",
            "path": "/request-book/<int:book_id>/",
            "description": "Student requests a book",
            "auth_required": true,
            "request_schema": {
              "body": {}
            },
            "response_schema": {
              "200": "Form with error",
              "302": "Redirect with success message"
            }
          },
          {
            "method": "POST",
            "path": "/issue-book/",
            "description": "Librarian issues a book to a student",
            "auth_required": true,
            "request_schema": {
              "body": {
                "student_id": "string",
                "book_id": "integer"
              }
            },
            "response_schema": {
              "200": "Form with error",
              "302": "Redirect on success"
            }
          },
          {
            "method": "POST",
            "path": "/return-book/<int:tx_id>/",
            "description": "Librarian marks a book as returned",
            "auth_required": true,
            "request_schema": {
              "body": {}
            },
            "response_schema": {
              "302": "Redirect on success",
              "404": "Transaction not found"
            }
          },
          {
            "method": "GET",
            "path": "/my-requests/",
            "description": "Student views their book requests",
            "auth_required": true,
            "response_schema": {
              "200": "HTML requests page"
            }
          },
          {
            "method": "GET",
            "path": "/manage-requests/",
            "description": "Librarian manages all book requests",
            "auth_required": true,
            "response_schema": {
              "200": "HTML manage requests page"
            }
          },
          {
            "method": "GET",
            "path": "/export-transactions-csv/",
            "description": "Export transaction data as CSV",
            "auth_required": true,
            "response_schema": {
              "200": "CSV file download"
            }
          },
          {
            "method": "GET",
            "path": "/export-transactions-pdf/",
            "description": "Export transaction data as PDF",
            "auth_required": true,
            "response_schema": {
              "200": "PDF file download"
            }
          }
        ]
      },
      {
        "name": "Dashboard API",
        "description": "JSON API endpoints for dashboard statistics and charts",
        "files": [
          "portal/views.py",
          "portal/api_dashboard.py",
          "portal/api_urls.py"
        ],
        "endpoints": [
          {
            "method": "GET",
            "path": "/api/dashboard/stats/",
            "description": "Get overall library statistics",
            "auth_required": true,
            "response_schema": {
              "200": "JSON with total_books, issued_books, overdue_books, students"
            }
          },
          {
            "method": "GET",
            "path": "/api/department-issues/",
            "description": "Books issued by department",
            "auth_required": true,
            "response_schema": {
              "200": "JSON array of department issue counts"
            }
          },
          {
            "method": "GET",
            "path": "/api/monthly-trends/",
            "description": "Monthly book issue trends",
            "auth_required": true,
            "response_schema": {
              "200": "JSON array of monthly data"
            }
          },
          {
            "method": "GET",
            "path": "/api/most-issued-books/",
            "description": "Most frequently issued books",
            "auth_required": true,
            "response_schema": {
              "200": "JSON array of books with issue counts"
            }
          },
          {
            "method": "GET",
            "path": "/api/overdue-books/",
            "description": "List of overdue books",
            "auth_required": true,
            "response_schema": {
              "200": "JSON array of overdue transaction records"
            }
          },
          {
            "method": "GET",
            "path": "/api/low-stock-books/",
            "description": "Books with low available copies",
            "auth_required": true,
            "response_schema": {
              "200": "JSON array of low-stock books"
            }
          },
          {
            "method": "GET",
            "path": "/api/student-issued/",
            "description": "Books currently issued to the logged-in student",
            "auth_required": true,
            "response_schema": {
              "200": "JSON array of issued books"
            }
          },
          {
            "method": "GET",
            "path": "/api/student-history/",
            "description": "Transaction history for the logged-in student",
            "auth_required": true,
            "response_schema": {
              "200": "JSON array of historical transactions"
            }
          }
        ]
      },
      {
        "name": "Departmental and E-Resources",
        "description": "Browse library resources by department and e-resources by letter",
        "files": [
          "portal/views.py",
          "portal/urls.py"
        ],
        "endpoints": [
          {
            "method": "GET",
            "path": "/departments/",
            "description": "List all academic departments",
            "auth_required": false,
            "response_schema": {
              "200": "HTML departments page"
            }
          },
          {
            "method": "GET",
            "path": "/departments/<int:dept_id>/books/",
            "description": "List books for a specific department",
            "auth_required": false,
            "response_schema": {
              "200": "HTML department books page",
              "404": "Department not found"
            }
          },
          {
            "method": "GET",
            "path": "/eresources/<str:letter>/",
            "description": "List e-resources starting with a given letter",
            "auth_required": false,
            "response_schema": {
              "200": "HTML e-resources page"
            }
          }
        ]
      },
      {
        "name": "Library Services",
        "description": "Student and staff services like study room booking, ask librarian, news, and contact",
        "files": [
          "portal/views.py",
          "portal/urls.py"
        ],
        "endpoints": [
          {
            "method": "GET",
            "path": "/contact/",
            "description": "Contact page",
            "auth_required": false,
            "response_schema": {
              "200": "HTML contact page"
            }
          },
          {
            "method": "GET",
            "path": "/opening-hours/",
            "description": "Library opening hours",
            "auth_required": false,
            "response_schema": {
              "200": "HTML opening hours page"
            }
          },
          {
            "method": "POST",
            "path": "/ask-librarian/",
            "description": "Submit a query to the librarian",
            "auth_required": false,
            "request_schema": {
              "body": {
                "name": "string",
                "email": "string",
                "message": "string"
              }
            },
            "response_schema": {
              "200": "Form with errors",
              "302": "Redirect on success"
            }
          },
          {
            "method": "POST",
            "path": "/book-study-room/",
            "description": "Book a study room",
            "auth_required": true,
            "request_schema": {
              "body": {
                "room_id": "integer",
                "date": "string",
                "time_slot": "string"
              }
            },
            "response_schema": {
              "200": "Form with errors",
              "302": "Redirect on success"
            }
          },
          {
            "method": "GET",
            "path": "/news/",
            "description": "Library news and announcements",
            "auth_required": false,
            "response_schema": {
              "200": "HTML news page"
            }
          }
        ]
      }
    ],
    "known_limitations": [
      {
        "issue": "Session-based authentication used; no token-based API auth",
        "location": "portal/views.py",
        "impact": "API endpoints require browser session cookies for auth"
      },
      {
        "issue": "SQLite used in development; may differ from production PostgreSQL behavior",
        "location": "anu_lms/settings.py",
        "impact": "Minor query behavior differences between environments"
      }
    ]
  }
}
